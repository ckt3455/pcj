<?phpnamespace backend\controllers;use backend\models\Goods;use backend\models\GoodsCategoryAttributes;use Yii;/** * OrderController implements the CRUD actions for Order model. */class AjaxController extends MController{    public function actionAjaxStatus(){        $id=Yii::$app->request->get('id');        $model=Yii::$app->request->get('model');        $attribute=Yii::$app->request->get('attribute');        if($id and $model and $attribute){            $data = call_user_func([$model, 'findOne'], $id);            if(isset($data[$attribute])){                if($data[$attribute]==1){                    $data[$attribute]=0;                }else{                    $data[$attribute]=1;                }                if($data->save()){                    return 0;                };            }        }        return 1;    }    public function actionCategory(){        $get=Yii::$app->request->get();        $goods_id=$get['goods_id'];        $id=$get['id'];        $category=GoodsCategoryAttributes::find()->where('FIND_IN_SET('.$id.',category_id)')->all();        $html='';        if($category){            if($goods_id){                $goods=Goods::findOne($goods_id);                $arr_goods=explode(',',$goods->search_value);                foreach ($category as $k=>$v){                    $arr=explode('|',$v->value);                    $arr_html='';                    foreach ($arr as $k2=>$v2){                        $arr_value=$v->title.'|'.$v2;                        if(in_array($arr_value,$arr_goods)){                            $arr_html.='<label><input type="checkbox" name="Goods[category_search][]" checked value="'.$v->title.'|'.$v2.'">'.$v2.'</label>';                        }else{                            $arr_html.='<label><input type="checkbox" name="Goods[category_search][]" value="'.$v->title.'|'.$v2.'">'.$v2.'</label>';                        }                    }                    $html.='      <div class="form-group field-goods-is_new">                <label class="control-label">'.$v->title.'</label>                <div>                    '.$arr_html.'                </div>                <div class="help-block"></div>            </div>';                }            }else{                foreach ($category as $k=>$v){                    $arr=explode('|',$v->value);                    $arr_html='';                    foreach ($arr as $k2=>$v2){                        $arr_html.='<label><input type="checkbox" name="Goods[category_search][]" value="'.$v->title.'|'.$v2.'">'.$v2.'</label>';                    }                    $html.='      <div class="form-group field-goods-is_new">                <label class="control-label">'.$v->title.'</label>                <div>                    '.$arr_html.'                </div>                <div class="help-block"></div>            </div>';                }            }        }        return json_encode($html);    }}