<?phpnamespace frontend\models;use backend\models\PerformanceLog;use backend\models\Provinces;use backend\models\UserLevel;use Yii;/** * This is the model class for table "zs_provice_user". * * @property integer $id * @property string $name * @property integer $parent_id * @property string $username * @property string $password_hash * @property string $auth_key * @property integer $created_at * @property integer $updated_at */class ProvinceUser extends FrontendUser{    const sex_1 = 1;//男    const sex_2 = 2;//女    const sex_3 = 3;//未知    const type_1 = 1;//省级    const type_2 = 2;//市级    const type_3 = 3;//区级    const type_4 = 4;//门店    public static function tableName()    {        return '{{%province_user1}}';    }    public static $type = [        self::type_1 => "省级",        self::type_2 => "市级",        self::type_3 => "区级",        self::type_4 => "门店",    ];    /**     * @inheritdoc     */    public function attributeLabels()    {        return [            'id' => 'ID',            'name' => '昵称',            'provinces' => '省',            'username' => '用户名',            'password_hash' => '密码',            'birthday'=>'生日',            'head'=>'头像',            'city'=>'市',            'area'=>'区',            'type'=>'级别',            'sex'=>'性别',            'mobile_phone'=>'手机号码',            'email'=>'电子邮箱',            'parent_id'=>'上级用户',            'auth_key' => 'Auth Key',            'created_at' => 'Created At',            'updated_at' => 'Updated At',            'goods_payment'=>'积分上限',            'available_payment'=>'可用积分'        ];    }    /**     * @param bool $insert     * @return bool     * 自动插入     */    public function beforeSave($insert)    {        if($this->isNewRecord)        {            $this->password_hash = Yii::$app->security->generatePasswordHash($this->password_hash);            $this->auth_key   = Yii::$app->security->generateRandomString();            $this->created_at=time();            $this->birthday=strtotime($this->birthday);            if($this->name==''){                $this->name=$this->username;            }        }        else        {            //验证密码是否修改            $old_pwd = Yii::$app->user->identity['password_hash'];            $new_pwd = $this->password_hash;            if($old_pwd != $new_pwd)            {                $this->password_hash = Yii::$app->security->generatePasswordHash($this->password_hash);            }            $this->birthday=strtotime($this->birthday);            $this->updated_at=time();        }        return parent::beforeSave($insert);    }    /**     * 用户等级     */    public function getLevel(){        return $this->hasOne(UserLevel::className(), ['id' => 'user_level']);    }}